# Smush-LUT
<img src="https://scanmountgoat.github.io/Smush-Material-Research/assets/images/post_processing/neutral_lut.png" height="auto" width="100%">  

Create color grading 3D LUTs for Smash Ultimate. Learn more about how these textures work and the effects that can be achieved in the 
[post processing page](https://scanmountgoat.github.io/Smush-Material-Research/post_processing) of the Smash Ultimate material website. Download the executable in 
[Releases](https://github.com/ScanMountGoat/Smush-LUT/releases).

## Usage Instructions
1. Find a screenshot of the stage to edit. Any 8 bit tiff, png, or jpeg will work, but using a screenshot of the actual stage will produce a more accurate result. The image should be at least 256x256 pixels. 
2. Drag the screenshot image onto `smush_lut.exe`. The program will generate a `.lut.png` file that includes a neutral color grading LUT written to the top of the image. The image will be darker than the original to account for the post processing applied by Smash Ultimate. See step 4 for how to preview the final result. 
3. Edit the generated `.lut.png` image in an image editor like Photoshop, Gimp, etc. Only use adjustments or layers that affect the entire image such as levels, curves, exposure, gradient maps, etc. The LUT can't store the changes in the image made by brushes or image overlays. 
4. To preview what the final result will look like in game, apply a levels adjustment with the input white level set to 181 or 71%. This is usually the top bar in a levels dialog. Make sure to undo the levels adjustment before saving! For programs with adjustment layers such as Photoshop, create a levels adjustment layer at the top of the layer stack and hide the adjustment layer before saving. [Krita](https://krita.org/en/) is a free image editing program that supports nondestructive adjustment layers. 
5. Drag the edited `.lut.png` image onto `smush_lut.exe` to create a `color_grading_lut.nutexb` from the edits made to the image.  
6. Replace the stage's `color_grading_lut.nutexb` with the one generated by `smush_lut.exe`. The file size will be 1:1 with the original, so there usually won't be any issues compressing it to the correct size. Most edits to 8 bit images introduce some subtle banding artifacts, which also helps with compression. 

## Previewing Color Grading LUTs
Convert the LUT to a 16x16x16 .cube file using the executable. 
Example: `smush_lut.exe sepia.png sepia.cube` or `smush_lut.exe sepia.nutexb sepia.cube`. 
Cube files can be opened in many video editing and image editing software. Photoshop and Affinity Photo support important and exporting LUTs as .cube files. Other image editing software may have plugins that support .cube files. 

### Photoshop (CS6 or later)
Create a new color lookup adjustment layer by clicking the adjustment layer icon on the layers panel and selecting "Color Lookup". 
Click the "Load 3D LUT" dropdown and then click "Load 3D LUT" again to open a file dialog to select the .cube file exported earlier. Leave the color channel settings at default. 

### Affinity Photo 
Similar to Photoshop, create a new LUT adjustment layer by clicking the adjustment layer icon and selecting "LUT". Click "Load LUT" and select the .cube file exported earlier. 
